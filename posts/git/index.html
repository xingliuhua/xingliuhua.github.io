<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>git - xingliuhua博客</title><meta name="Description" content="git"><meta property="og:title" content="git" />
<meta property="og:description" content="git" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xingliuhua.github.io/posts/git/" />
<meta property="og:image" content="https://xingliuhua.github.io/logo.png"/>
<meta property="article:published_time" content="2019-05-06T17:55:28+08:00" />
<meta property="article:modified_time" content="2019-05-06T17:55:28+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://xingliuhua.github.io/logo.png"/>

<meta name="twitter:title" content="git"/>
<meta name="twitter:description" content="git"/>
<meta name="application-name" content="xingliuhua博客">
<meta name="apple-mobile-web-app-title" content="xingliuhua博客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://xingliuhua.github.io/posts/git/" /><link rel="prev" href="https://xingliuhua.github.io/posts/tree/" /><link rel="next" href="https://xingliuhua.github.io/posts/docker/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "git",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/xingliuhua.github.io\/posts\/git\/"
        },"genre": "posts","keywords": "git","wordcount":  3269 ,
        "url": "https:\/\/xingliuhua.github.io\/posts\/git\/","datePublished": "2019-05-06T17:55:28+08:00","dateModified": "2019-05-06T17:55:28+08:00","publisher": {
            "@type": "Organization",
            "name": "xingliuhua"},"author": {
                "@type": "Person",
                "name": "xingliuhua"
            },"description": "git"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="xingliuhua博客"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo.png"
        data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x"
        data-sizes="auto"
        alt="/logo.png"
        title="/logo.png" /></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="xingliuhua博客"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo.png"
        data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x"
        data-sizes="auto"
        alt="/logo.png"
        title="/logo.png" /></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">git</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://xingliuhua/github.com.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>xingliuhua</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E7%AC%94%E8%AE%B0/"><i class="far fa-folder fa-fw"></i>笔记</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2019-05-06">2019-05-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3269 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#git-config">git config</a></li>
            <li><a href="#git本地仓库">git本地仓库</a>
              <ul>
                <li><a href="#提交快照">提交快照</a></li>
                <li><a href="#工作区和暂存区">工作区和暂存区</a></li>
                <li><a href="#撤销工作区的修改">撤销工作区的修改</a></li>
                <li><a href="#撤销暂存区的内容">撤销暂存区的内容</a></li>
                <li><a href="#本地仓库回退版本">本地仓库回退版本</a></li>
                <li><a href="#删除文件">删除文件</a></li>
              </ul>
            </li>
            <li><a href="#远程仓库">远程仓库</a>
              <ul>
                <li><a href="#git-fetch">git fetch</a></li>
                <li><a href="#添加远程仓库">添加远程仓库</a></li>
                <li><a href="#克隆远程仓库">克隆远程仓库</a></li>
                <li><a href="#推送到远程仓库">推送到远程仓库</a></li>
              </ul>
            </li>
            <li><a href="#分支">分支</a>
              <ul>
                <li><a href="#合并分支">合并分支</a></li>
                <li><a href="#stash">stash</a></li>
              </ul>
            </li>
            <li><a href="#tag">tag</a></li>
            <li><a href="#gitignore">.gitignore</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h3 id="git-config">git config</h3>
<p>git的配置分为全局和各仓库的单独配置。
查看配置 git config &ndash;list
如果当前目录是git仓库就能看到该仓库的单独配置。
git config &ndash;global user.name配置全局用户名
git config &ndash;global user.email配置全局邮箱</p>
<p>git config &ndash;local user.name在仓库地址路径配置该仓库的特定用户名，如果不指定&ndash;local默认也是该效果，配置邮箱等信息同理。</p>
<p>如果不对各仓库配置自己的邮箱，可能会造成邮箱不必要的暴露。</p>
<h3 id="git本地仓库">git本地仓库</h3>
<p>各区之间数据状态转换流程
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./pic5.png"
        data-srcset="./pic5.png, ./pic5.png 1.5x, ./pic5.png 2x"
        data-sizes="auto"
        alt="./pic5.png"
        title="./pic5.png" /></p>
<h4 id="提交快照">提交快照</h4>
<p>在目录中git init命令初始化一个本地仓库，生成.git文件。
git add 文件名  //添加到版本控制
git commit -m &ldquo;message&rdquo;  //提交到本地
git status  //查看当前文件状态
git diff 文件名 //查看文件内容的变化,默认是工作区的文件变化，加上&ndash;staged选项可以查看暂存区文件的变化。
git log //查看提交记录，这里有记录的id，这个id是一个sha1结果，与svn提交记录每次递增不同，git的是无规律的。</p>
<p>标准的git commit分为3个部分，header、body、footer,后两个一般不用。
heder结构为 type(scope):subject</p>
<p>Type一般有几种类型：</p>
<ul>
<li>feat:新功能</li>
<li>fix:修复bug</li>
<li>style:格式</li>
<li>refactor:代码重构</li>
<li>chore:项目构建</li>
</ul>
<p>比如fix(pay):修复了xxbug</p>
<h4 id="工作区和暂存区">工作区和暂存区</h4>
<p>工作区就是项目所在的目录
.git是版本库，里面有暂存区stage(或者叫index)、还要为我们自动创建的master分支、还有HEAD指针。</p>
<p>文件修改后，用add命令放到暂存区，然后在通过commit命令放到分支上。每次的修改只有先add到暂存区才能被提交。</p>
<h4 id="撤销工作区的修改">撤销工作区的修改</h4>
<p>add前，发现写错了东西，想放弃修改的内容？
当然可以直接删除内容即可，如果内容太多记不住
<code>git checkout -- file可以丢弃工作区的修改：</code></p>
<p>$ git checkout &ndash; readme.txt
命令git checkout &ndash; readme.txt意思就是，把readme.txt文件在工作区的修改全部撤销，这里有两种情况：</p>
<p>一种是readme.txt自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p>
<p>一种是readme.txt已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。</p>
<p><code>总之，就是让这个文件回到最近一次git commit或git add时的状态。</code>
如果想撤销多个文件，可以使用git checkout &ndash; .</p>
<h4 id="撤销暂存区的内容">撤销暂存区的内容</h4>
<p>如果文件已经add到暂存区，好在没有commit到分支，发现有地方写错了想撤销怎么办？</p>
<p>Git同样告诉我们，用命令</p>
<div class="highlight"><pre class="chroma"><code class="language-tex" data-lang="tex">git reset HEAD &lt;file&gt;
</code></pre></div><p>可以把暂存区的修改撤销掉（unstage），重新放回工作区。</p>
<p>git reset命令既可以回退版本，也可以把暂存区的修改回退到工作区</p>
<h4 id="本地仓库回退版本">本地仓库回退版本</h4>
<p>git每次commit都是一个快照，方便以后查找或恢复。
在Git中，用HEAD表示当前版本，上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100。</p>
<p>git reset &ndash;hard HEAD^
这样就回到了上个快照，在查看git log发现刚提交的那条记录不在了。当然如果你还能记住刚才那个最新的快照id还是可以回去的。</p>
<p>如果记不住了就再也回不去了吗？
当然不是，Git提供了一个命令git reflog用来记录你的每一次命令。
然后
git reset &ndash;hard 快照id
就可以再回来啦。</p>
<p>git revert 也可以回退一个已经提交到仓库的版本
git revert 版本号 即可。会生成一个提交记录，提交记录明确记录着revert 的是哪个版本，原来的版本记录都是在的。如果对revert再revert一次，那就等于负负得正，回到原来的版本中。
<code>注意，revert针对最后一次的commit比较方便，如果想revert上上一次或更前面的，就会冲突。</code></p>
<p>如果修改已经push到远程了，需要本地回退后，在push一次</p>
<h4 id="删除文件">删除文件</h4>
<p>删除了文件，也属于文件变化，可以使用：</p>
<div class="highlight"><pre class="chroma"><code class="language-tex" data-lang="tex">git add 文件 //或者git rm 文件
git commit
</code></pre></div><p>来提交变化。
如果想撤销删除，可以参考上面的撤销工作区、暂存区内容。</p>
<h3 id="远程仓库">远程仓库</h3>
<p>本地仓库在自己的电脑上，其他人可以对仓库进行克隆，版本库就是完全一样的，没有主次之分。
一般情况下，大家都向一个电脑推送，拉取数据，那它就是远程仓库。</p>
<p>远程仓库的默认名称是origin。要查看远程库的信息，用git remote。</p>
<h4 id="git-fetch">git fetch</h4>
<p>Git fetct只拉取远程分支的变化，并不会真的把你本地的分支内容修改。
git pull = git fetch + git merge</p>
<h4 id="添加远程仓库">添加远程仓库</h4>
<p>一个本地库可以对应多个远程库，远程库的名字不能一样，可为origin、origin2等。
如果已经有了本地仓库，再建远程仓库，想把本地的仓库和远程仓库连接起来：
git remote add origin 远程仓库地址</p>
<p>添加后，远程库的名字就是origin，这是Git默认的叫法，也可以改成别的，但是origin这个名字一看就知道是远程库。</p>
<h4 id="克隆远程仓库">克隆远程仓库</h4>
<p>如果已经有了远程仓库，可直接克隆到本地即可
git clone 远程地址</p>
<h4 id="推送到远程仓库">推送到远程仓库</h4>
<p>把本地库的内容推送到远程，用git push命令，实际上是把当前分支master推送到远程。</p>
<p>由于远程库是空的，我们第一次推送master分支时，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。
以后就可以这样推送了</p>
<p>git clone [<!-- raw HTML omitted -->] [&ndash;] <!-- raw HTML omitted --> [<!-- raw HTML omitted -->]</p>
<p>git clone默认是全克隆，也就是下载所有的分支。下载后默认切换到master分支，git clone -b 分支名指定下载后自动切换的分支。
git clone  &ndash;single-branch   clone only one branch, HEAD or &ndash;branch 很明显，这个才是下载单一的分支，可以节省很多时间。</p>
<p>也可以指定下载后的目标文件</p>
<div class="highlight"><pre class="chroma"><code class="language-tex" data-lang="tex">git push origin master
</code></pre></div><h3 id="分支">分支</h3>
<p>创建分支，git branch dev
切换分支，git checkout dev
查看当前分支，git branch
删除分支，git branch -d dev</p>
<h4 id="合并分支">合并分支</h4>
<p>当前master分支，合并git merge dev</p>
<p>当Git无法自动合并分支时，就必须首先解决冲突。解决冲突后，再提交，合并完成。</p>
<p>解决冲突就是把Git合并失败的文件手动编辑为我们希望的内容，再提交。</p>
<p>用git log &ndash;graph命令可以看到分支合并图。</p>
<p>git rebase 意思是变基，其实也是合并分支的作用。</p>
<p>git rebase和git merge区别：
git rebase后变成了一个线，且不会生成新的合并节点。
git merge后两个分支记录依然各自存在，会生成新的合并节点。
git merge冲突后需要手动add并commit，git rebase自动生成一次提交。</p>
<p>当完成一个特性的开发并将其合并到 master 分支时，我们有两种方式：git merge 和 git rebase。
看merge图解：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./pic1.png"
        data-srcset="./pic1.png, ./pic1.png 1.5x, ./pic1.png 2x"
        data-sizes="auto"
        alt="./pic1.png"
        title="./pic1.png" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./pic2.png"
        data-srcset="./pic2.png, ./pic2.png 1.5x, ./pic2.png 2x"
        data-sizes="auto"
        alt="./pic2.png"
        title="./pic2.png" />
rebase图解：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./pic3.png"
        data-srcset="./pic3.png, ./pic3.png 1.5x, ./pic3.png 2x"
        data-sizes="auto"
        alt="./pic3.png"
        title="./pic3.png" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./pic4.png"
        data-srcset="./pic4.png, ./pic4.png 1.5x, ./pic4.png 2x"
        data-sizes="auto"
        alt="./pic4.png"
        title="./pic4.png" />
我们可以看到，merge后会产生一个多余的commit,但是每个提交记录先后顺序不变。</p>
<p>rebase没有生产新的commit，把两个分支合成一个线性的记录，可读性更强，但是提交记录的先后顺序变了。</p>
<p>**总结：**当需要保留详细的合并信息的时候建议使用git merge，特别是需要将分支合并进入master分支时；当发现自己修改某个功能时，频繁进行了git commit提交时，发现其实过多的提交信息没有必要时，可以尝试git rebase。</p>
<h4 id="stash">stash</h4>
<p>stash是存放的意思。
当在工作区(或者已经add到暂存区)写代码时，突然要切换分支，但是工作进行到一半还不应该commit。可以先把工作区stash起来，带解决完bug后在切换回来，恢复修改即可
保存：git stash
查看保存列表：git stash list
恢复：git stash pop</p>
<h3 id="tag">tag</h3>
<p>创建分支， git tag v1.0
创建标签默认是基于最新的提交，当然也可以指定提交id，如：git tag v0.9 f52c633
查看所有标签，git tag
删除tag， git tag -d v0.1
推送标签到远程，git push origin tagname</p>
<h3 id="gitignore">.gitignore</h3>
<ul>
<li>文件或目录前加 / 表示仓库根目录的对应文件；</li>
<li>匹配模式最后跟反斜杠 / 说明要忽略的是目录；</li>
<li>要特殊不忽略某个文件或目录，可以在模式前加上取反 ! 。</li>
<li>规则以两个星号**开头，后接一个斜杠，这样的规则会在所有路径或子路径中尝试进行匹配。比如，**/foo会匹配到文件foo或者目录foo</li>
<li>如果规则是斜杠/后跟两个星号，然后再跟一个斜杠的形式，这里的两个星号就会匹配0+个目录，这里的0+是指可以没有，也可以是多个。再举个例子，比如a/**/b会匹配a/b、a/x/b、a/x/y/b这些</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2019-05-06</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/git/">git</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/tree/" class="prev" rel="prev" title="树结构"><i class="fas fa-angle-left fa-fw"></i>树结构</a>
            <a href="/posts/docker/" class="next" rel="next" title="docker">docker<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://xingliuhua/github.com.io" target="_blank">xingliuhua</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":15},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
